<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mo Yang" />

<meta name="date" content="2022-12-08" />

<title>HW22031</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">HW22031</h1>
<h4 class="author">Mo Yang</h4>
<h4 class="date">2022-12-08</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>texts:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(<span class="fu">head</span>(iris))</span></code></pre></div>
<pre><code>## % latex table generated in R 4.2.2 by xtable 1.8-4 package
## % Thu Dec  8 23:29:50 2022
## \begin{table}[ht]
## \centering
## \begin{tabular}{rrrrrl}
##   \hline
##  &amp; Sepal.Length &amp; Sepal.Width &amp; Petal.Length &amp; Petal.Width &amp; Species \\ 
##   \hline
## 1 &amp; 5.10 &amp; 3.50 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   2 &amp; 4.90 &amp; 3.00 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   3 &amp; 4.70 &amp; 3.20 &amp; 1.30 &amp; 0.20 &amp; setosa \\ 
##   4 &amp; 4.60 &amp; 3.10 &amp; 1.50 &amp; 0.20 &amp; setosa \\ 
##   5 &amp; 5.00 &amp; 3.60 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   6 &amp; 5.40 &amp; 3.90 &amp; 1.70 &amp; 0.40 &amp; setosa \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
<p>figures:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Sepal.Width, <span class="at">data =</span> iris))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAABcAACgAADoAAFgAAGYAFwAAOmYAOpAAZpAAZrYNAAANACghAAA6AAA6ADo6AEk6AGY6Ojo6OpA6kNtJADpYtv9mAABmACBmADpmAGZmOgBmOpBmZmZmkJBmtrZmtv9m2/+BZgCB//+QOgCQZgCQkGaQnFGQtpCQtv+Q2/+2ZgC2tma225C2/7a2//++vr7bkCrbkDrbkJDb25Db/7bb/9vb///fU2v/tmb/vFH/25D//7b//9v///9hun0dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQr0lEQVR4nO2dDX/kNhGHBSEQAuRoGxoKlFtoKEdMe8W8XNzd8/f/WGj05hlb8ki2vOtt5/+7yya2rJGfHY1eLNuqF81KXboAe5cAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGK0PaCPz8roMbLv9HRwv3U3LzN7k2ps3upg0nbuP1Us63ydA9A9fHRq9myXArr7QNNHjrkSQO4jJQFkz6V1de34APXCnY7eePP1zYv5w/xozE7zu0toDoEPfbbDJgRIpzXbtfQmb8ZnvaL45/WgVpf1+PBoT7ZzkaO5fa9/R4Aal9Kc9MHXTptPc/efYRMFNHiQNxOyXlH8swFqjcPA19rdvtf/zD7rI3CuzQDo9MWL9Rf9u09octC/6xzwpjigYCZkvaL452vFDj4a6GKfnuxZwunYE+5wFQMPsRXQJwyJIRki1Pi8MaBgJmS9ovhn8qDjA7hR5xtlS82eTjsBpAPH7TfWg3xCI131wGPIppgHBTPt9QDShX4cF9XVqokHmYrhqphPaD672299G+U3xQF5M1fkQfaUaBtsapCPQS0AehwqRqcGQMPnl752BXbxGOTMhKxXFP9sgE5P0PxCWTUq86V6p4GN0NR8fL77oKvPwTqP9jgI0i6hzapR9+6vLu5BjzZAezMh6xXFP18/qIVKBh0U6yBKBZfynRVNRb21MejmxVdAm9DKNu54EwGkAd59aHw/yDjbNfSDrlwCiJEAYiSAGAkgRgKIkQBiVBmQuhpdClDd7LaTAGIkgBgJIEYCiJEAYnRVgI6f2AkQmKCAazfs1bAKugpArjfSARmA1N73cEXj+GbN/E2u7eoJ62en7P/m5t0ndiJVQ+rMta8zuNAVAFLh59EBau3Uo7kutrWuENDxwU6NfnyOrQOprasC9P2vv4Jfj7/9HVwxVj97P3dYJV0BoN6PGTv106/Mx+1fD6ff/+bQ4hUbW2kjQHC1wETQ9jb+NS8A1Nz8XXtQ9/Obd9qDvv/V5/3pD2dwoW0A2SUXEEorABpVMc3+J3/p/2WofV5SqGXaBJANn3B9ry4g14qZj9OTcjUMdx8/Pq+7+reioCWA0PXeEaDyeagEIOgkuivqqPsIPaPOcisywVqvmbBHDXBzXyUG+fQIEGAw/SDSfRyiUjjG/rWc1kYxKKx7UhUAhfOLehDuPh4/+5utYoPX+c+ltDZrxWwl+/hcA5AXjkFduO6Ouo+wnOH42QfIHjAobCtOi9UCQLAuolVqXSekYrfKe5CucQDHVDzjJCoGiNLitQCQDr2wDqyZXa1bzS4vD0hH6NOfdgDIrjXxC76WqjIgH7ObWBUjteo8gGDVbKp9qmyXl/Gg1oYk3yqMMOC4vH0Mau5hEZjtKC/W1lOuMw3X5q2Y/pZgGdwqPisAZZ7fCqeh+VRPuHF2ZSdrMJWGnYm9ugm3zW7uZKe+ZWkKoGEXDTsu8TkBwfpSr4u0YumTjfSX/SaJQUOOoTuIPGiHg9Uts0udLAWkQsqVBV/WzF+uis1liaaZQuVaPSu0bCwGMwsPh7PYLcgSA8JjsXW5FieEwTwMfdZdU6gPaDTDgcdi67ItTWhuvPnk/TCI3tZufo7OaYbIU8VGOSCYTzVLB/YGyDpNoHO5OWkYxjeP+6tipOtTL9sFCZv7mclmUEZ3siogN+Kq1fWheVdPCEpPRS+47MPKjbhQDBp3nvfXUWRnQ6pXAkViUHpGcVnuJQlD/ZntKDJP4NgAUI89KD0nvSz3BQnXTUlvAYgO4JOXfRblviThbq5qkBrkAeFOURRQblhaDmg3VzXCyQYaIQY5dJEYlB2WlgPazVUNnKVv33FTGWvz82vdYkC7u6oRGvhLA/Kt2C4uPaMzJ1NAc52iwfymHrRS9bq5oVahfOc6ReTIigXdI6BAAztNjz5op2jR5cNCQBeftB9lkuj6jHqNdJy/UUGHhOYBNiufJVMJEHaa0MD3YbrDhyUSkLYqaEgYnkFy+emO0QyHJ4HitmvMEC20r25BUStmR1k76ChydUcREbv0mBlaSzzIrtBsduBBuOsz3oei00AoPn6di06LYhC40LrHNdVt5lN7Rh6UGr/OdoqWNPOmKVt5n4TJbs6zc0JEOu6GBn5Ux0L4HgqBAEU9kS9GYcL87GY8O69JTn/1Sr1qjaIPYkQM0GYwaiND9QHNeHbmSGCULDgAwPGfr7SZ7ymtIZ/UKpmrAJSsb+Q7d38YOMh1HKRh3BGxOhmrjIuSIZvw9PSYNeXqn6qZTFMCaK4qKsIHcPjtqOFShpHbkbR6Tg9q/VOzu+jjs/uiGFRQ3zQH9weqVTb6ulo3t1hoiFejbLNUAgjdTZrqb0dasdRYMh/QK2qYSBfScgJGibbK26wCiL8VAT1Is0vcDvXdd31P/yv3f7y9j6SN/n9FafWnsaFoPup1Jr+knVJA/K0IuR403ZCMSOwXCd4xaZjINVfrIKamFTSd5R6UcyuCv9lnPgZlFM/ti3g+3eRiM8oNN1wuINnjfE1LFKkOIPZWBHZeNg9QXvs+wRMADZiCAeUidiLc1IhBG92KECke3ZSK21M8oRVzP/FYzG97DS0ePiperCzhIF3tVoRXq0Tx0r2hsAdONJo9qVV4LIY6APFDowWtmXBBdq9BaT+JDsZVIpyQGESGGnT2LAPRLgANesWigJBP+F6h7/vFsicxCA3gR8uIWERLAJlb1pt1TxaZCb4ouExpoS0ZXYPhJ/K6fqh1GV60AFB389JCkF5FKAcQqW8kXMVTkz2DB41pDZ0ity3apDEFnUkIvcB25pkKhdnFNk/6IkN1wZv6+OAgkk9IjVr7AX+8SZsv6ExC874GDWibSftYX8Q3P6P4rfIBRfaMe0gT92QKmk7oPWijSfvpGePGOmyaRN/IQXEbpAOADbippNyCphPaGNSuewZdQaOoJj9j7ffkqGRYCTVNUVrm5wTRwlZMrX3IynJA0zFE2ltGGUXmUzAtq2hDkF3MairJjnzNQ3QdjSHysknsIu5GEK0A9O+zXVlFXzPtAaIxhJqrVYPFPLsIUTGg1k00J9eKl2VXcoiF0GMP6se+RVNPLca6WDEFRKWAYFEHtF9d/GWN2VpaY0etNB5xkXyn9YnbP5af/i8rmRnE655Qe8YgTY9DHjSqby5fhSYRJyYxn8zInl0y89MMMD4+f6rWTXas8aD0GMLs971K/zs+NjFRUKegHhD0fpp11avIbuzAUX8R04pMIqbN5wSkZYDWP+Fxea8h7QdkCig5Cglp6fhsktZ3lLLLZX46QIsrmMooO58FLRMFRMwwBYn0pIcEfQJcMkfzcy2gUXYLD8RIRgPYSAcgbX48FpsmuD5Ao8Z6OoBlh7E4my0ADZXk8s/uoH+g6MO2UhRQpCotBVRNGwCyP3FwYfIZkkXC1cIYVE2VmnmUFR13cEMJMpqfTVBSsIqq0opFO0Xrcp+aq57wrNkRWkPIFkDRLEN4Hhr8CrlWT3iR7PohIOFRWi6mekONatoOkPsYxh15hyZjdZn9atoaUHoMwRwZ35ltv5q2iEEo23QXOVmWHz4gMowVD+KylxjE5y+t2KwB6QedRxsBqvrqmotqG0BVX11zWW0CqO6ray6rTQClX12zKLuLakMP6mu9uuai2igG1X11zSW1WStmK9l4DUiF62Jn1sX6QVejDQEteI3lrJXlOzfLd0nCQQKIkQBiJIAYCaD6EkBrrAggAbTOigC6agkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGG0JyN4i428hOj6o7Ds+6ZFhTUmWiJ3unI9KKNbxDSobvGAy+wFp5EhYU8K9lSphB27m3sNT+hPCD5KxE9m5z96hR8LZ5t7LRuzYP/bzOqexWlQy4hNFR5YBInbsS2N397aioOZTFZ5T0N1++5T/0AJ8ZFkVI3YsrR28xiAueCxj37uHorWwHiT3IYTkyLJIS+zY8LMuCG3ezLvvz75MoOjL9Inh+aDHh0znI3auApB7ebQNBEVvknaJywIJsbPzKmbloqYtZVGo9kcWuQGxs/MgbYvnvj+7vjHzyyRHkj9YETt7b+ZNyXyohQfIZV/VJ0cWxSBqZ+cdxb6xYwTbqHSq4NlE5Mim5Ehvxx7a7nqo8YOQAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBhdDFDjnsJyMOsxOvefKrHuAL21fHtdDhB+ywmccuS0BZCXAJoqANKnC4vjQfB4Pb/UBRaufG0AuRVU8IIvuyhGH2EYmR/+AJPHBuB2AWjwIFiDaRZLwaqpzq7tcYuE7j7Asir7KMcBkD/AUMxfj5+vfQGy7wnubt9br2lsFYNFhnrP6YsX604IUDhg3UrNGV26FTsQQJ2vU/Z8XQwa9sDyMQIoHHB62ojQvjyo821/iwHBksXGxqfbb6gHhQN0RfwxxKDQbBEPMvcXHGyYGVUx2s41K9cjxrQvQKEBdyuc3Qmfnr6EmA3QOl/FHl3Nwk6zRfu/F0CPNkAbJOAI9g4W7xEN3CJnnUdBygM8cVdXqkM4wLjSyhW/Ue0DkCagW3HfDzLVa+gH9b79Nmt6NQyLVKm3vh9kXWv1it+oZLDKSAAxEkCMBBAjAcRIADESQIyWAZp2WT8+H9wDE5hBI3pzAGeli86iDRllG7O2WmVf6nA/ZGruJxusmPmCkWoBgjvdbXeOGRDlA0pMMzqVGLND3+ZLMGknSHwmvtfprHTTQlUCZLvD5t5H5t7vWoBKjJmR3emLd3AnK31exgiQqQdUiwEdH97CHfww03mwo29SWDcTenzz7sHNoQ7zpfYEAyCX9PQEGR5sSj3KgAPv/vv054foLEaRMeM13d3/4PS1N9mtbcxKO/naVgCCISUEAXDgxt50GQo9zISqg60NaL6UAvJJT09ujOpnW+136zZOVGbs3gQB+ND/rbtHrUyHuysAmQkHP+tgvjdwJ1Pd0dSpedbI3Qc8X0oAhaR+BiPMtoY5WHcXPEyJ6YOO/7BlKDHWwdj/4D9OfnJpamV6Y/8KQIch0yFU6LMIdxqHsx3NlxJAaNLUzYH5ubIQHdwhnRn1K1QJso3pwAPQ9AeEIDM1F7dCQnhFQAS8dt4wE+qefWBqY5gvpYDIFVb9o00BiirPmPabztwufrCPFzr0CStbATKZe0qdm74ChTLj+VIKyCdlPYiozFjfPLb2ITvwcQEPMvmGZ674dqJ3QQpg4PlSAigk9aUMs62zgMqM9d0vTQPe/eKPLr+Ela1ikG/F4KQ7haZOTVsHRcXzpQRQSBpKObQvjzNVrMhYf/z0jQ1UkPTkL1FOrVRtxTCgzrUnYd7TzYQeH0IPY5gvNd++uy72GJIOpdS7bv8JfQfooSRjUIkx+9Y4/4H7QS/USq1+UIxYdHvR83CwllwpXWwsKHIalQCRp44hLSizHRdMgmXukatUbSw2VWQUA1pS5k4tvEa6GlC90fyPSAKI0f8BrA1L/wyc4vkAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABfVBMVEUAAAAAABcAACgAADoAAD8AAFgAAGYAFwAAJFkAOmYAOpAAP3EARn4AZpAAZrYNAAANACghAAAnAAAnWYg1kNs6AAA6ADo6AEk6AGY6NVQ6Ojo6OpA6kME6kNtGADVGJABJADpMn/9Uqv9Ytv9ZJABZJwBZKwBZiJ5jJABmAABmACBmADpmAGZmOgBmZmZmkJBmtrZmtv9m2/9sJABxPwBxnp6BZgCB//+QOgCQOjqQZgCQkGaQnFGQtpCQtv+QwcCQ28GQ2/+enp6enrCensCesNCewOClfjqwnp6wnrCwnsCws4aw0M6w0O+2ZgC2tma225C2/7a2//++vr7AcT/AiFnAnnHAnojAnp7AnrDAsNDAwZDA4ODA4P/QsJ7Q0MDQ4NDQ77bQ7//bfivbkCrbkDrbtmbb25Db/7bb/9vb///fU2vgwIjgwJ7g79Dg///v0LDv////tmb/vFH/25D/4KX/4MD/4OD/77P/79D//7b//9v//+D//+/////dEniNAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAS4klEQVR4nO1diX/kNhUWBAIECGeWc4BtucLC0uFqYFkgaSlbYKfHcoSjCxTMsSE0dYfATrL+25He02nLfrYsz9iDvt9vZny8keRv3nuSno5hRUIj2KYLMHYkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggkgggYglaHsyJjbO/RBkszQhiCFnuPlgf7xWJ/g6UZITRBq8N5kTP+2n11k+UZHRyCFpycLBHkwDKx/dXh3qPVYTIxB7aTZjvHV0eJHxeDVPNXRwww89wTpozId44b7tZisd56diCCQA+Fz29AIoiw1ykRxP2PRoRaTDEDz5JJW1se8IO5pIBf3Lmzcwwn8LaAm3AsBeEr4oMTaS7ZBGHKWkjltLp1RzzEQn1lgXmZknTC4BqU8aItD+RzcKNDOvgD5MwiaCEl+bES1Oks9v5mLlkE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" /><!-- --></p>
<p>tables:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<p>Exercises 3.3, 3.7, 3.12, and 3.13 (pages 94-96, Statistical
Computating with R).</p>
</div>
<div id="section" class="section level1">
<h1>3.3</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>The <span class="math inline">\(\operatorname{Pareto}(a, b)\)</span>
distribution has cdf <span class="math display">\[
F(x)=1-\left(\frac{b}{x}\right)^a, \quad x \geq b&gt;0, a&gt;0 .
\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform
method to simulate a random sample from the Pareto(2, 2) distribution.
Graph the density histogram of the sample with the Pareto <span class="math inline">\((2,2)\)</span> density superimposed for
comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>At first we have <span class="math inline">\(F(x)=1-\left(\frac{b}{x}\right)^a, x \geq b&gt;0,
a&gt;0\)</span>, through derivation, it can be concluded that <span class="math inline">\(F^{-1}(U)=\frac{b}{\sqrt[a]{1-u}},0&lt;u&lt;1\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>b<span class="sc">/</span>((<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a)) <span class="co">#give the derivation</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#density histogram of sample</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">bquote</span>(<span class="fu">Pareto</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.01</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,a<span class="sc">*</span>(b<span class="sc">^</span>a)<span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>(y<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>After comparison, it can be seen that it almost fits perfectly.</p>
</div>
</div>
<div id="section-1" class="section level1">
<h1>3.7</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Write a function to generate a random sample of size <span class="math inline">\(\mathrm{n}\)</span> from the <span class="math inline">\(\operatorname{Beta}(a, b)\)</span> distribution by
the acceptance-rejection method. Generate a random sample of size 1000
from the Beta <span class="math inline">\((3,2)\)</span> distribution.
Graph the histogram of the sample with the theoretical Beta <span class="math inline">\((3,2)\)</span> density superimposed.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(Beta(a,b)\)</span> has the density
function <span class="math inline">\(f(x)=\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1},0&lt;x&lt;1\)</span>,
we choose samples that satisfy the following conditions <span class="math display">\[
\frac{f(x)}{cg(x)}=\frac{\frac{1}{B(a,b)}x^{a-1}(1-x)^{b-1}}{\frac{1}{B(a,b)}(1)}=x^{a-1}(1-x)^{b-1}&gt;u
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10001</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#give the function</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>samplebeta<span class="ot">=</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">0</span> <span class="co">#counter for accepted</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k<span class="sc">&lt;</span>n) {</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span><span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">&gt;</span>u){</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="co">#we accept x</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      y[k]<span class="ot">=</span>x</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#give the needed sample</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">samplebeta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>) </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">bquote</span>(<span class="fu">B</span>(<span class="dv">3</span>,<span class="dv">2</span>)))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fu">dbeta</span>(y,<span class="dv">3</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmOgBmOjpmOmZmZmZmkLZmkNtmtttmtv+QOgCQOjqQOpCQZgCQZjqQkLaQttuQtv+Q2/+2ZgC2Zjq2kDq2kGa2kJC22/+2/7a2///T09PbkDrbkJDb25Db/9vb////tmb/tpD/25D/27b//7b//9v///+/g3fdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIyElEQVR4nO2d6WLiNhhFlekkdA2zdAndhy7TwW2HEuD9H63IG5Zsc5H0GX/ge34EDJaQT7RYsiybPTmJGTsB2qEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQClgnZ//op2+e+bj5dIiU5Bz2/f4502bz8MnxIlgtYm55MyU2zfvLMvu5+MufPzyfObw4df5R9uPruAIVWCjHmwW7vFo33Zvj5+VLOZ5R++zNVk98OXMi2CnuzL8+s7m3Wy/O8+M4eMUn5UsVuY7w77LUyucDN7HDxpqgQdXg9HvJ3nGWO3yF+y8quC7fyh8bJbvBi8kGkT9GT/NErVP/MuB6Wg/dKxNwiqBD2/tjaWpi44mTH3Xe3Zutwl82qoAdAiqODuKa9m6myx/PxgqF0Rb2blh+uub2XRJchWy9u5U246MslmVlXcazN4JaRFUO5k9/uh6HiC2hVxZl6+r8NNS1DecnmC9kvXwaEEHovVBAW9+FDVQWVrv3Wbsd3CPDbDTaYOqorYw7EVW+Ynio4Qv2GfXCtmbO1bnQcdyprF5pHf7r4tdix7GqYsWtl0zoMKPV/a2rcsW83O6rKqa2qT+fZ0zqRdMqf7lbP7oauumU5fzGW3aNUs62+7dpxOb96jHA868vcvXbttvpjMeJDP7vtWIWtz1rBjMjoF7Xd/4DHpnyc8Jq0ICgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQGuUJDxGfbXBo19EMzKhYI8KAhAQYCWoEHrpKsVVOtYDZujrlOQ9dLMQBTUpCVk5WYiCvKLVJ6NKKigVaCq7GMmLMhvpToFHTPRBAU1KuTVqt1q+aZkf1w0tmHwDPQKqr6X/XHR2IbBK0P9goq3UxXkl6QuQbnEiQryC1K3oNVkBfnlqE/QYWuSgkyvkNb2BDurplWKTgmaYg5q9b2uTtCw48N+GUKCRBMhfERDCPL7FhTkRxkqSDQV6gWZ8CImmgwKwr8vibggG2G4IMF01DFt5xKLFUn7zuPTIShftNCkLjczyDlIhCC5hLgRJTsapIWNESSWEj+erF7+SiS6JPQJsgtgPVWrzKZHl0gdV5QgqaQco7FrqhVm1vFZaJD2VYeg7by9clhCdJIxKRH0qvCTkH32qgRJ9cOrN5WgbHxBrekaCgQtj6kZv5lvXWyPEySUmOpNlYOEokuKpDXMHCdIJDUa+2JXLGi3aK6kmhxdXySnjQQMuQokp4hiO38sl5Y9eR6dVRXUuq+mulVB51E+EMTSt0ioVCV9nYK283px4r6zJZFSLydIID3NrsZj/piG/n7YZXJQawxai6Dl/cfN7GG/PDFsVq9vPWAd1B5iTRGUnqBGX+wpXzn9ZFejqsl7s9mNC7IPIBi5q9ExBp0kKDlFjSL2YNdKr56akxxdQnilgg7F5+5dx2LgnfTls8TklIOBOgUlxSJ0bX4AQTL/MzHSouu+iqFFEOxnhUWXEFipoKXEMypUCBK9O6rRzEs8oyIlNX1XMYIF+b5kjqjR0eqj7vD3F8QbFnROA48fFROVGDAGnSpIptwfH2F1CmgxTpB3WDoFnTNghi1GCzL9R6hEkAwqBcnUjDLECjp1mUeNoEMhu/+4TGvsIwWdvIqhRdD67l1me/OXv3AYeOk0XFCKoUYz/5gPpI4wHnQdguyJohU0wuSF0CMOF5RgqJWDlklPfYtJCDoxVCKorIMSnzt5y4KKU8XEWVQRCYGXeSQExRsa/TwIX8VI7qwmDX+MLeiMqxipgrxPYwUVfbHU53LerqDyGcpZ4lz7UEHnXOZRIWhdVc6b2QVasbDxHw2CGuM8p67Nnxsd3Ksn7UMKOr7GHFGjB3aJrsY1CoIzf0Kig3t1J52C6r3cA6Gg1l7ucVxGUF2gY44oVVDgaapxD+MqBMErXiHRwb3co7gCQWJoFlS+uw5B5sQRUVDwaiXTEyR0xBQ0UUHBd8hJ7W6uQ1D4ci7TEtQeY6UgZw8KwjuMJSh/r1EQmEJGQa2WloK8T73EjibIbigWdFwSm4K8T72U3q6gyNvCjZfQmxUUe1t4XjdOQFD0Tb2mncyRBK2CV1MO2T36tnD/zOdWBaXkoEkIir0tXPrmC72C4m4LF787JWl3bROoTEfvnYKOm+UEwekJOue28ON1Vk2CxulqeJeeW8MbqhhD0A1DQQDhzurtIdxZvT2EuxplpKoZTtDZ06xQpOD7tK9Tgyfsfn4OSvvRqxV0Rmf1vEhvVhDurJ4X6e0KEoqUgtK+pyAKSvuegiYv6JagIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAElB6+YCVuvg1az8EIGrqTnB7cM+k1ZpqREUZFeQqVeRcTbCg9vtsMWMnOCZ3ZAxJCeouChULh7jbIQH35frgkb/+kPgr/cjJ6hYeaicOORshAe37+5/DBHkBFcq6FObv8tLrs5GePB8M6gOcoOrLGJFBVBWA85GePC8xAQJ8n4wvInoQ6mg4DVB3eD2CQ+bmcgMFJ1FLN+IL2LhNWA/OivprJypcn4t4gQPz7/9qG3mA3OQE7ywlbZUVIXeE8XAM2knuMo6KC8YNoXFWUgW3I44wffBXQ0nuH00s8wsQXZWARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAO2C7JyxxiMqL492QdVT3kdDu6D9+sVfr2Qm9MahXtB+aURmzMeiX5DQjPlY1AvaLb4eddVG9YKy+38XYy7aqF2QXZpQZsJzJNoF2bnAjWeZXx7tgkaHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A9qPA1SJXf5NgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="conclusion-1" class="section level2">
<h2>Conclusion</h2>
<p>After comparison, it can be seen that it almost fits perfectly.</p>
</div>
</div>
<div id="section-2" class="section level1">
<h1>3.12</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(\operatorname{Gamma}(r, \beta)\)</span>
distribution and <span class="math inline">\(Y\)</span> has <span class="math inline">\(\operatorname{Exp}(\Lambda)\)</span> distribution.
That is, <span class="math inline">\((Y \mid \Lambda=\lambda) \sim f_Y(y
\mid \lambda)=\lambda e^{-\lambda y}\)</span>. Generate 1000 random
observations from this mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10002</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a Exp-Gamma mixture</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>r<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">=</span><span class="fu">rgamma</span>(n,r,beta) <span class="co">#lambda is random</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#now supply the sample of lambda&#39;s</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rexp</span>(n,lambda) <span class="co">#the mixture</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>] <span class="co">#show the first 50 datas to refer to</span></span></code></pre></div>
<pre><code>##  [1] 1.176661017 0.634962787 0.280530534 0.630094089 0.403233161 0.678954100
##  [7] 0.237279670 0.008997365 0.438300336 0.042269324 0.406305387 0.207949596
## [13] 2.363213791 0.071836583 0.607353542 0.081521861 0.250348618 0.025041819
## [19] 0.351919848 0.233193516 1.383505169 0.054333166 0.724664211 0.413560462
## [25] 0.628644153 0.114086605 0.196070665 0.372960320 0.088027622 0.002141164
## [31] 1.358731701 0.237534310 0.151049211 0.224104669 0.297128311 1.496847520
## [37] 1.752006050 0.528057569 0.072176588 0.039163312 0.255345262 0.037997127
## [43] 1.300102369 0.019786987 0.299059645 0.003621109 0.245400277 0.278445874
## [49] 0.345401894 0.139497343</code></pre>
<p>And then please refer to the next question.</p>
</div>
</div>
<div id="section-3" class="section level1">
<h1>3.13</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>It can be shown that the mixture in Exercise <span class="math inline">\(3.12\)</span> has a Pareto distribution with cdf
<span class="math display">\[
F(y)=1-\left(\frac{\beta}{\beta+y}\right)^r, \quad y \geq 0 .
\]</span> (This is an alternative parameterization of the Pareto cdf
given in Exercise 3.3.) Generate 1000 random observations from the
mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#we use the sample from the previous question</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="st">&quot;Gamma-Exp&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,r<span class="sc">*</span>(beta<span class="sc">^</span>r)<span class="sc">*</span><span class="dv">1</span><span class="sc">/</span>((beta<span class="sc">+</span>y)<span class="sc">^</span>(r<span class="sc">+</span><span class="dv">1</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion-2" class="section level2">
<h2>Conclusion</h2>
<p>After comparison, it can be seen that the empirical and theoretical
(Pareto) distributions are almost the same.</p>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises in class. <a href="#question1ans">Jump to the
Answer</a></p></li>
<li><p>Exercises 5.6 (page 150, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Exercises 5.7 (page 150, Statistical Computing with R). <a href="#question3ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercises in class</h3>
<p><strong>Problem.</strong> For <span class="math inline">\(n=10^4, 2
\times 10^4, 4 \times 10^4, 6 \times 10^4, 8 \times 10^4\)</span>, apply
the fast sorting algorithm to randomly permuted numbers of <span class="math inline">\(1, \ldots, n\)</span>.</p>
<p>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</p>
<p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n \log (n)\)</span>, and graphically show the
results (scatter plot and regression line).</p>
<p><strong>Solution.</strong> Here, we use the code on bb system for the
fast sorting algorithm.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}<span class="co">#one sort</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we can apply the algorithm to the different data of n and
calculate computation time.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">c</span>() <span class="co">#store the time of each simulation</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){ <span class="co">#100 simulations</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    test<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[i])</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    b[j]<span class="ot">=</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  a[i]<span class="ot">=</span><span class="fu">mean</span>(b)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 0.0203 0.0410 0.0823 0.1252 0.1683</code></pre>
<p>Then we regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=nlog(n)\)</span> and show the results on the
figure, note that the default value here is 95% confidence interval.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span>n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(a<span class="sc">~</span>t))<span class="co">#regression</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a ~ t)
## 
## Residuals:
##          1          2          3          4          5 
## -0.0009317  0.0004662  0.0006368  0.0005012 -0.0006723 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 4.455e-03  6.999e-04   6.365  0.00785 ** 
## t           1.822e-07  1.287e-09 141.543 7.78e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0008552 on 3 degrees of freedom
## Multiple R-squared:  0.9999, Adjusted R-squared:  0.9998 
## F-statistic: 2.003e+04 on 1 and 3 DF,  p-value: 7.775e-07</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>a))<span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;darkred&quot;</span>)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">formula=</span>y<span class="sc">~</span>x,<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Linear Regression Plot&quot;</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">size=</span><span class="dv">15</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see from both the p-value(big enough) and the figure that it
fits well.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 5.6</h3>
<p><strong>Problem.</strong> In Example <span class="math inline">\(5.7\)</span> the control variate approach was
illustrated for Monte Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x d x .
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(\operatorname{Cov}\left(e^U,
e^{1-U}\right)\)</span> and <span class="math inline">\(\operatorname{Var}\left(e^U+e^{1-U}\right)\)</span>,
where <span class="math inline">\(U \sim
\operatorname{Uniform}(0,1)\)</span>. What is the percent reduction in
variance of <span class="math inline">\(\hat{\theta}\)</span> that can
be achieved using antithetic variates (compared with simple <span class="math inline">\(\mathrm{MC})\)</span> ?</p>
<p><strong>Solution.</strong> According to U~U(0,1), We have
1-U~U(0,1)</p>
<p><span class="math inline">\(E\left(e^U \right)=\int_0^1 e^u d
u=e-1,\quad E\left(e^{2U} \right)=\int_0^1 e^{2u} d
u=\frac{1}{2}(e^2-1),\)</span></p>
<p>then <span class="math inline">\(Var\left(e^U\right)=\frac{e^2-1}{2}-(e-1)^2\)</span>,</p>
<p>also <span class="math inline">\(Var\left(e^{1-U}\right)=\frac{e^2-1}{2}-(e-1)^2\)</span></p>
<p><span class="math display">\[
\begin{align*}
\\Cov\left (e^{U},e^{1-U}\right)&amp;=E\left(e^{U}\cdot
e^{1-U}\right)-E\left (e^{U}   \right ) E\left ( e^{1-U} \right )
\\&amp;=e-(e-1)\cdot (e-1)
\\&amp;=3e-e^2-1,
\\Var\left ( e^U+e^{1-U} \right )
&amp;=Var\left(e^U\right)+Var\left(e^{1-U}\right)+2Cov\left(e^U,e^{1-U}\right)
\\&amp;=e^2-1-2(e-1)^2+2e-2(e-1)^2
\\&amp;=-3e^2+10e-5.
\end{align*}
\]</span></p>
<p>And using antithetic variates can achieve the percent reduction:</p>
<p><span class="math inline">\(\frac{Var\left(e^U\right)-Var\left(\frac{e^U+e^{1-U}}{2}\right)}{Var\left(e^U\right)}=-\frac{e^2-2e-1}{2(e-1)(e-3)}=98.3835\%\)</span></p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercise 5.7</h3>
<p><strong>Problem.</strong> Refer to Exercise 5.6. Use a Monte Carlo
simulation to estimate <span class="math inline">\(\theta\)</span> by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<p><strong>Solution.</strong> We refer to the Example 5.7 to do this
problem.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13245</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>U1<span class="ot">=</span><span class="fu">runif</span>(m)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>U2<span class="ot">=</span>U1[<span class="dv">1</span><span class="sc">:</span>m<span class="sc">/</span><span class="dv">2</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>T1<span class="ot">=</span><span class="fu">exp</span>(U1) <span class="co">#simple MC</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>T2<span class="ot">=</span>(<span class="fu">exp</span>(U2)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U2))<span class="sc">/</span><span class="dv">2</span> <span class="co">#antithetic variate</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(T1)</span></code></pre></div>
<pre><code>## [1] 1.719325</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(T2)</span></code></pre></div>
<pre><code>## [1] 1.717623</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(T1)<span class="sc">-</span><span class="fu">var</span>(T2))<span class="sc">/</span><span class="fu">var</span>(T1)</span></code></pre></div>
<pre><code>## [1] 0.9839807</code></pre>
<p>After comparison, we can see that this result is very close to the
theoretical value.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 5.13 (Page 151, Statistical Computing with R). <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Exercises 5.15 (Page 151, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 5.13</h3>
<p><strong>Problem.</strong> Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are close to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1 .
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling? Explain.</p>
<p><strong>Solution.</strong> First, we choose two importance functions
which can be close to the <span class="math inline">\(g(x)\)</span>.
Maybe we can choose <span class="math display">\[
f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2 / 2} / [1-\phi(1)],\quad x&gt;1
\\f_2(x)=\sqrt{e}xe^{-x^2/2},\quad x&gt;1
\]</span> <span class="math inline">\(f_1\)</span> is obviously form a
standard normal distribution. And <span class="math inline">\(f_2\)</span> is from a Weibull distribution.</p>
<p>Now we can use importance sampling method and compare variance.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10234</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">=</span>se<span class="ot">=</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>g<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">runif</span>(m) <span class="co">#using f1, inverse transformation method</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">qnorm</span>(u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>))<span class="sc">+</span><span class="fu">pnorm</span>(<span class="dv">1</span>))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">=</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>))</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">mean</span>(fg)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">sd</span>(fg)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">runif</span>(m) <span class="co">#using f2, inverse transformation method</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">=</span><span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">*</span><span class="fu">exp</span>((<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>]<span class="ot">=</span><span class="fu">mean</span>(fg)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>]<span class="ot">=</span><span class="fu">sd</span>(fg)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat,se) <span class="co">#final estimate and standard deviation</span></span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4013921 0.3996748
## se        0.2634931 0.1229762</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)<span class="sc">$</span>value <span class="co">#theoretical value</span></span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
<p>It can be seen that the estimated values using the two functions are
very close to the theoretical values, and the variance of <span class="math inline">\(f_2\)</span> is smaller, which indicates that the
values of <span class="math inline">\(f_2(x)\)</span> are closer to
those of <span class="math inline">\(g(x)\)</span>. We can give an
intuitive explanation through the following drawing.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">=</span><span class="fu">dnorm</span>(x)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">=</span>x<span class="sc">*</span><span class="fu">exp</span>((<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>g<span class="ot">=</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,g,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">lwd=</span>w)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span>w)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,f2,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">lwd=</span>w)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;g&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lwd=</span>w,<span class="at">inset=</span><span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb/9vb////tmb/25D//7b//9v///8WKNMvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG3ElEQVR4nO2d63ajNhRGSZqk7aSt23FbWhLz/o85gO0J4Igtobvn2z8my2vkY7MtHZB0jJtebNLkfgOlI0GABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQEFhQUw25BIUNF497FBS0+2QWZN+D3WOHiZRY0GpoOwxxlxcJGekuh1jISAUICt6NJMg+tn+kAgQFR4KSxZYgjlSKoJCJSIIcY3tFKkVQmbEliCNFEnRsmufTYRg3fwQJ50YFgtqn/wdHz33//vrFPlyoNFS+oNNh0NI9fO3PqmzDhUrU5Qt6fx1GVvf4b3/91zLcDyNoZw8KRfmCPnLQpMo7nCM+sYezy8Nf00d7ifQDnMVcluSPQ0bomgSCUofbiE2LznPeXsYP9Fi0oACJen+Ey4klpaDW5Sw2/UdOQW16QesopsEfkqp6UKJwgWKfc1ArQUaSncWmU/yAIQNthvMefp7XQY9/f3/X8S4Um8v1Yde4Xyh6JyhfwV10QbPr5z1TjXyCphw0W4GIOlk94zRZDYRH7K5ZXP0X2oN8qWGyev0U9uQgbyoQNAyy81nM0H8wnFcaqkGQbzgJKneIvf3ycVqRoFveXx8laINucfVfsiCPLOR1HfSlq0bQ7lc0LLmaHq+oRZBHFzIsuRoer6lGUK7YEgRIECBBQF5Bbov2O/N0zYLcwklQHDRZTRZbgjhS6YL2pCEJChTbKlLpgvLGliCOJEEQKaqgc7FEsHC2eMSeago+dqpiCbpu+myULziEc87T+wWdDg9f+3asPv0eKU4PuuwXhulBCQVd6oPiV3cMfWjcMixjiF0Fm/7ekKbCbCwVLULQ+jv667+3HBP0oH6qESpCkDOzeoK4Z7G3l58CCXLc4fBc7vjI0bFP88M5sz5Bi3oUXSje0C7qdRIIci4kD4BH7HbZ50tfk977Iruf+fayrPfSEFvRnj+8KgvJHfpcDZNVn0JywxPuSpBXIbk35QtSGTBQbyH5baSaepBtGipfUKRCcturpwoEeReSG550P4J2hQt1jX2PguDr2l6x/SIVIWghxd/RvQn6xIZZkY24m+64nwIEmfqKwVGIHOVEZkGbQylQzvYjryA6/gIM5RaE7XIryp6DuOWNoqTKyhd0m4ok6KZxxnFWyaJ9PkVV9KDpCUtFyXxVI2iViiTos+fkGGc1CcqiqC5BS0VJZNUmaJ6KJMjw1KQDrUJBaRVVKWg10AK8nY1XCt5wIvze/E2Aq6IqBSXZm981Z3F/leAN+4R78wm6URRBCffmd05+HV4geMM+cXXHzFAMTbFyUNKbvO1dRLGKHbzhhOXefMDjapo4mnIv2i+OyPMAm4Wk1D+xkOBCcd0Ddvlqbgj/Rv0aLvEoJCdfW49vNe3A7bjzrkn3Zl/4uCpBscLFQ4KAaierqah4spqGbFONaoghyGKy6hbUsl2WZnuaW/Qgt6D3JshisuoW9O4E8WTVLej9CQocVILCtJOgEpvtbB42qASFaXd/gu4JCQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIKAGILmv5ZnZHUHYyPt7N5j2xxhIbi/Lhk/U7M5EQQtfi3PxPoOxibGMpLOylBHK+UDbz/buZ4RXlC3sTP9wfoOxgam3x8+HSw+86FzsKDt7bxPCS5o9Wt50Niqb1gJap/+ZEGt0+iaiJGD7AUdrVq2FhqHwWORg46/2iW+GVkFwf7jtZFFq3HTlwWd7xd+dDKUU1BneT45HfDQx61wix50flmnRJRRkFX/ObekMTadnWwFbdwv/BPyCWrtkwEe0uVmreb7XC+iOZ3rswlqrY7mrMbOOPcgl2hXcgla38HYxHjUs7IbakpNxqRXR5Je38HYyNF25FjlIPtoVzRZBSQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIKF3QWEk9FUvnonRBY/HU9s2KIlO6oL57/Oc35+8PBKR4Qf3R7csnoSlfUOdYMxeY4gWdDr+7fwMlIMULap/+sytyjUTpgsZbE+74ElM4Shd0rpPOmKZLF5QdCQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAg4Bvx4QG8+LXliwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Now we can se <span class="math inline">\(f_2\)</span> is a little
closer.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 5.15</h3>
<p><strong>Problem.</strong> Obtain the stratified importance sampling
estimate in Example 5.13 and compare it with the result of Example
5.10.</p>
<p><strong>Solution.</strong> We use stratified importance sampling
method and compare it with the result of Example 5.10. We divide the
interval (0,1) into five subintervals <span class="math inline">\(I_j=\{x:a_{j-1}\leq x&lt;a_j\},\quad
a_j=F^{-1}(j/5)\)</span>. And note that <span class="math inline">\(F(x)=\frac{1-e^{-x}}{1-e^{-1}},\quad
0&lt;x&lt;1\)</span>. And the importance function should be <span class="math display">\[
\frac{5e^{-x}}{1-e^{-1}},\quad \frac{j-1}{5}&lt;x&lt;\frac{j}{5}
\]</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10023</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>M<span class="ot">=</span><span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">5</span> <span class="co">#number of strata</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">50</span> <span class="co">#number of time to repeat the estimation</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>T2<span class="ot">=</span><span class="fu">numeric</span>(k)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>estimates<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>g<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">=</span><span class="fu">runif</span>(M<span class="sc">/</span>k)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(j<span class="dv">-1</span>)<span class="sc">/</span>k<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>k)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    fg<span class="ot">=</span><span class="fu">g</span>(x)<span class="sc">/</span>(k<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    T2[j]<span class="ot">=</span><span class="fu">mean</span>(fg)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  estimates[i]<span class="ot">=</span><span class="fu">mean</span>(T2)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(estimates)</span></code></pre></div>
<pre><code>## [1] 0.1049541</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(estimates)</span></code></pre></div>
<pre><code>## [1] 1.781705e-09</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>k<span class="sc">*</span><span class="fu">mean</span>(estimates) <span class="co">#the estimated value</span></span></code></pre></div>
<pre><code>## [1] 0.5247707</code></pre>
<p>This result is basically consistent with that in Example 5.10, and it
has a high variance reduction rate.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercise 6.4 (Page 180, Statistical Computing with R). <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Exercise 6.8 (Page 181, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Exercise in class. <a href="#question3ans">Jump to the
Answer</a></p></li>
</ol>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 6.4</h3>
<p><strong>Problem.</strong> Suppose that <span class="math inline">\(X_1, \ldots, X_n\)</span> are a random sample from
a from a lognormal distribution with unknown parameters. Construct a
<span class="math inline">\(95 \%\)</span> confidence interval for the
parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo
method to obtain an empirical estimate of the confidence level.</p>
<p><strong>Solution.</strong> From the question, we can learn that <span class="math inline">\(logX\sim N(\mu,\sigma^2)\)</span>, and the two
parameters are unknown. Let <span class="math inline">\(Y=logX\)</span>,
using the knowledge of mathematical statistics we can have <span class="math inline">\(\frac{\sqrt{n}(\bar{Y}-\mu)}{S}\sim
t(n-1)\)</span>. A <span class="math inline">\(100(1-\alpha)\%\)</span>
confidence interval is given by<span class="math inline">\(\left(\bar{Y}+\frac{S}{\sqrt{n}}t_{\alpha/2}(n-1),\bar{Y}+\frac{S}{\sqrt{n}}t_{1-\alpha/2}(n-1)
\right )\)</span>.</p>
<p>Now we use a Monte Carlo method to obtain the empirical estimate.
Here we assume that <span class="math inline">\(n=20,\mu=0,\sigma^2=4\)</span>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span> <span class="co">#repeated test times</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">log</span>(x)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  t1<span class="ot">=</span><span class="fu">mean</span>(y)<span class="sc">+</span><span class="fu">sd</span>(y)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  t2<span class="ot">=</span><span class="fu">mean</span>(y)<span class="sc">+</span><span class="fu">sd</span>(y)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(t1<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> t2<span class="sc">&gt;</span><span class="dv">0</span>) UCL[i]<span class="ot">=</span><span class="dv">1</span> <span class="co">#count the number of intervals that contain mu=0</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(UCL)</span></code></pre></div>
<pre><code>## [1] 0.959</code></pre>
<p>The empirical estimate of the confidence level is 95.9% and is close
to 95%.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 6.8</h3>
<p><strong>Problem.</strong> Refer to Example 6.16. Repeat the
simulation, but also compute the <span class="math inline">\(F\)</span>
test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} \doteq 0.055\)</span>. Compare the
power of the Count Five test and <span class="math inline">\(F\)</span>
test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal
distributions.)</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>count5test<span class="ot">=</span><span class="cf">function</span>(x,y){</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span>x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  Y<span class="ot">=</span>y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  outx<span class="ot">=</span><span class="fu">sum</span>(X<span class="sc">&gt;</span><span class="fu">max</span>(Y))<span class="sc">+</span><span class="fu">sum</span>(X<span class="sc">&lt;</span><span class="fu">min</span>(Y))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  outy<span class="ot">=</span><span class="fu">sum</span>(Y<span class="sc">&gt;</span><span class="fu">max</span>(X))<span class="sc">+</span><span class="fu">sum</span>(Y<span class="sc">&lt;</span><span class="fu">min</span>(X))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy))<span class="sc">&gt;</span><span class="dv">5</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span>n2<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">=</span>mu2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">=</span><span class="fl">1.5</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.055</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>cfp<span class="ot">=</span>fp<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n1,mu1,sigma1)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">rnorm</span>(n2,mu2,sigma2)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  cfp[i]<span class="ot">=</span><span class="fu">count5test</span>(x,y)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  fp[i]<span class="ot">=</span><span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(cfp) <span class="co">#Count Five test</span></span></code></pre></div>
<pre><code>## [1] 0.3172</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fp<span class="sc">&lt;=</span><span class="fl">0.055</span>) <span class="co">#F test</span></span></code></pre></div>
<pre><code>## [1] 0.425</code></pre>
<p>We have computed the powers of these two tests when <span class="math inline">\(n_1=n_2=20\)</span>, next we will use different
sample sizes to compute and compare.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">300</span>,<span class="dv">20</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>M<span class="ot">=</span><span class="fu">length</span>(n)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>cfpower<span class="ot">=</span>fpower<span class="ot">=</span><span class="fu">numeric</span>(M)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  n0<span class="ot">=</span>n[i]</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">=</span><span class="fu">rnorm</span>(n0,mu1,sigma1)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>   y<span class="ot">=</span><span class="fu">rnorm</span>(n0,mu2,sigma2)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>   cfp[j]<span class="ot">=</span><span class="fu">count5test</span>(x,y)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>   fp[j]<span class="ot">=</span><span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a> cfpower[i]<span class="ot">=</span><span class="fu">mean</span>(cfp) <span class="co">#Count Five test</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a> fpower[i]<span class="ot">=</span><span class="fu">mean</span>(fp<span class="sc">&lt;=</span><span class="fl">0.055</span>) <span class="co">#F test</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n,cfpower,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;power&quot;</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n,fpower,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="fl">0.2</span>,<span class="fu">c</span>(<span class="st">&quot;Count Five&quot;</span>,<span class="st">&quot;F&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">inset=</span><span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The powers of both of them increase with the increase of sample size,
and gradually tend to be 1.0, and we can see the power of F test is
always greater than that of Count Five test.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercise in class</h3>
<p><strong>Problem.</strong> If we obtain the powers for two methods
under a particular simulation setting with 10,000 experiments: say,
<span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. Can we say the
powers are different at <span class="math inline">\(0.05\)</span>
level?</p>
<ul>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>Which test can we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis
testing.</p></li>
</ul>
<p><strong>Solution.</strong></p>
<ul>
<li>We assume that at <span class="math inline">\(0.05\)</span> level,
the power of the first method is <span class="math inline">\(\pi_1\)</span> and that of the second method is
<span class="math inline">\(\pi_2\)</span>. Then we can have the
hypothesis test problem:</li>
</ul>
<p><span class="math display">\[
H_0:\pi_1=\pi_2\quad\quad\longleftrightarrow\quad\quad H_1:\pi_1\ne
\pi_2
\]</span></p>
<ul>
<li><p>We cant use Z-test, because we dont know the variance of these
two sets of powers if we regard them as normal distributions. But we can
use two-sample t-test, for we can calculate the variance from the data.
And if we generate data in pairs and calculate the power function, we
can also use paired-t test and McNemar test.</p></li>
<li><p>We should know the variance of two for the two-sample t-test and
paired-t test.</p></li>
</ul>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 7.4 (Page 212, Statistical Computing with R). <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Exercises 7.5 (Page 212, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Exercises 7.A (Page 213, Statistical Computing with R). <a href="#question3ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 7.4</h3>
<p><strong>Problem.</strong> Refer to the air-conditioning data set
aircondit provided in the boot package. The 12 observations are the
times in hours between failures of airconditioning equipment [63,
Example 1.1]: <span class="math display">\[
3,5,7,18,43,85,91,98,100,130,230,487 .
\]</span> Assume that the times between failures follow an exponential
model <span class="math inline">\(\operatorname{Exp}(\lambda)\)</span>.
Obtain the MLE of the hazard rate <span class="math inline">\(\lambda\)</span> and use bootstrap to estimate the
bias and standard error of the estimate.</p>
<p><strong>Solution.</strong> Suppose <span class="math inline">\(X_1,X_2,\cdots,X_n\)</span> to be the times sample
between failures, from the question we know <span class="math inline">\(X\sim\operatorname{Exp}(\lambda)\)</span>. The
likelihood function is <span class="math inline">\(L(\lambda,\boldsymbol{x})=\lambda^ne^{-\lambda\sum_{i=1}^{n}x_i}\)</span>.</p>
<p><span class="math display">\[
log(L)=nlog(\lambda)-\lambda\sum_{i=1}^{n}x_i,\\
\frac{\partial log(L)}{\partial \lambda}=n(\frac{1}{\lambda}-\bar{x}).
\]</span></p>
<p>Let <span class="math inline">\(\frac{\partial log(L)}{\partial
\lambda}=0\)</span>, we have <span class="math inline">\(\hat{\lambda}=\frac{1}{\bar{x}}\)</span>. Then we
use the function boot to calculate the theoretical value and the
bootstrap estimate of the bias and standard error.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="cf">function</span>(x,i){</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i])</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;boot&quot;</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">boot</span>(t,<span class="at">statistic =</span> p,<span class="at">R=</span><span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = t, statistic = p, R = 2000)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001245585 0.004197868</code></pre>
<p><span class="math inline">\(\hat{\lambda}=0.00925,\hat{bias}(\hat{\lambda})=0.00125,\hat{se}(\hat{\lambda})=0.00420\)</span></p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 7.5</h3>
<p><strong>Problem.</strong> Refer to Exercise 7.4. Compute <span class="math inline">\(95 \%\)</span> bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1 /
\lambda\)</span> by the standard normal, basic, percentile, and BCa
methods. Compare the intervals and explain why they may differ.</p>
<p><strong>Solution.</strong> According to the invariance of maximum
likelihood estimation, we have <span class="math inline">\(\bar{x}\)</span> to be the MLE of <span class="math inline">\(1/\lambda\)</span>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12344</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="cf">function</span>(x,i){</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x[i])</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>boot.obj<span class="ot">=</span><span class="fu">boot</span>(t,<span class="at">statistic =</span> m,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.5, 181.0 )   ( 23.5, 170.3 )  
## 
## Level     Percentile            BCa          
## 95%   ( 45.8, 192.7 )   ( 56.5, 223.3 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>These four intervals are all different, because the distribution of
this parameter is not completely normal.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercise 7.A</h3>
<p><strong>Problem.</strong> Conduct a Monte Carlo study to estimate the
coverage probabilities of the standard normal bootstrap confidence
interval, the basic bootstrap confidence interval, and the percentile
confidence interval. Sample from a normal population and check the
empirical coverage rates for the sample mean. Find the proportion of
times that the confidence intervals miss on the left, and the porportion
of times that the confidence intervals miss on the right.</p>
<p><strong>Solution.</strong> We use the sample <span class="math inline">\(X\sim N(0,1)\)</span>, the mean value is estimated
as <span class="math inline">\(\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12343</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>me<span class="ot">=</span><span class="cf">function</span>(x,i){</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x[i])</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the porportion that the intervals miss on the left and right</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>leftn<span class="ot">=</span>rightn<span class="ot">=</span>leftb<span class="ot">=</span>rightb<span class="ot">=</span>leftp<span class="ot">=</span>rightp<span class="ot">=</span><span class="fu">numeric</span>(m)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rnorm</span>(n)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  boot.obj<span class="ot">=</span><span class="fu">boot</span>(x,<span class="at">statistic =</span> me,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span><span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b<span class="sc">$</span>norm[<span class="dv">2</span>]<span class="sc">&gt;</span><span class="dv">0</span>) leftn[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b<span class="sc">$</span>norm[<span class="dv">3</span>]<span class="sc">&lt;</span><span class="dv">0</span>) rightn[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b<span class="sc">$</span>basic[<span class="dv">4</span>]<span class="sc">&gt;</span><span class="dv">0</span>) leftb[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">&lt;</span><span class="dv">0</span>) rightb[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b<span class="sc">$</span>percent[<span class="dv">4</span>]<span class="sc">&gt;</span><span class="dv">0</span>) leftp[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(b<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">&lt;</span><span class="dv">0</span>) rightp[i]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co">#the empirical coverage rates</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(leftn<span class="sc">+</span>rightn)<span class="co">#norm</span></span></code></pre></div>
<pre><code>## [1] 0.933</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(leftb<span class="sc">+</span>rightb)<span class="co">#basic</span></span></code></pre></div>
<pre><code>## [1] 0.931</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(leftp<span class="sc">+</span>rightp)<span class="co">#percent</span></span></code></pre></div>
<pre><code>## [1] 0.928</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the porportion that the intervals miss</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#norm</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(leftn),<span class="fu">mean</span>(rightn))</span></code></pre></div>
<pre><code>## [1] 0.031 0.036</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#basic</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(leftb),<span class="fu">mean</span>(rightb))</span></code></pre></div>
<pre><code>## [1] 0.031 0.038</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#percent</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(leftp),<span class="fu">mean</span>(rightp))</span></code></pre></div>
<pre><code>## [1] 0.033 0.039</code></pre>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 7.8 (Page 213, Statistical Computing with R). <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Exercises 7.11 (Page 213, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Exercises 8.2 (Page 242, Statistical Computing with R). <a href="#question3ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 7.8</h3>
<p><strong>Problem.</strong> Refer to Exercise 7.7. Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Solution.</strong> First, we write a function to calculate
<span class="math inline">\(\hat{\theta}\)</span>. Then we can use the
jackknife.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">list</span>(<span class="fu">c</span>())</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#write the function</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>pca<span class="ot">=</span><span class="cf">function</span>(x,i){</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  val<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x[i,]))<span class="sc">$</span>values</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(val[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(val))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(scor)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">pca</span>(scor,<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">pca</span>(scor,(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i])</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 7.11</h3>
<p><strong>Problem.</strong> In Example 7.18, leave-one-out ( <span class="math inline">\(n\)</span>-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">list</span>(<span class="fu">c</span>())</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(magnetic)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>e1<span class="ot">=</span>e2<span class="ot">=</span>e3<span class="ot">=</span>e4<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span>magnetic[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span>chemical[<span class="sc">-</span><span class="fu">c</span>(k,l)]</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    J1<span class="ot">=</span><span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    yhat11<span class="ot">=</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    yhat12<span class="ot">=</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[l]</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    e1<span class="ot">=</span><span class="fu">c</span>(e1,magnetic[k]<span class="sc">-</span>yhat11,magnetic[l]<span class="sc">-</span>yhat12)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    J2<span class="ot">=</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    yhat21<span class="ot">=</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    yhat22<span class="ot">=</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[l]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[l]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    e2<span class="ot">=</span><span class="fu">c</span>(e2,magnetic[k]<span class="sc">-</span>yhat21,magnetic[l]<span class="sc">-</span>yhat22)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    J3<span class="ot">=</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span>x)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    yhat31<span class="ot">=</span><span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k])</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    yhat32<span class="ot">=</span><span class="fu">exp</span>(J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[l])</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    e3<span class="ot">=</span><span class="fu">c</span>(e3,magnetic[k]<span class="sc">-</span>yhat31,magnetic[l]<span class="sc">-</span>yhat32)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    J4<span class="ot">=</span><span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span><span class="fu">log</span>(x))</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    yhat41<span class="ot">=</span><span class="fu">exp</span>(J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[k]))</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>    yhat42<span class="ot">=</span><span class="fu">exp</span>(J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span><span class="fu">log</span>(chemical[l]))</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>    e4<span class="ot">=</span><span class="fu">c</span>(e4,magnetic[k]<span class="sc">-</span>yhat41,magnetic[l]<span class="sc">-</span>yhat42)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>Comparing the results, we know the model 2 fits the data most.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercise 8.2</h3>
<p><strong>Problem.</strong> Implement the bivariate Spearman rank
correlation test for independence [255] as a permutation test. The
Spearman rank correlation test statistic can be obtained from function
cor with method = spearman. Compare the achieved significance level of
the permutation test with the <span class="math inline">\(p\)</span>-value reported by cor. test on the same
samples.</p>
<p><strong>Solution.</strong> We generate samples from the standard
normal distribution.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">list</span>(<span class="fu">c</span>())</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11111</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">12</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="dv">999</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>K<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">24</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="fu">numeric</span>(R)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>D0<span class="ot">=</span><span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="fu">sample</span>(K,<span class="at">size=</span><span class="dv">12</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">=</span>z[k]</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">=</span>z[<span class="sc">-</span>k]</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  D[i]<span class="ot">=</span><span class="fu">cor</span>(x1,y1,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">mean</span>(<span class="fu">c</span>(D0,D)<span class="sc">&gt;=</span>D0)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="dv">0</span>)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.223</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 1.3286, df = 10, p-value = 0.2135
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2398732  0.7864293
## sample estimates:
##       cor 
## 0.3873528</code></pre>
<p>We can learn that the two p-values are not really different, and they
both accept the null hypothesis.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 9.4 (Page 277, Statistical Computing with R). <a href="#question1ans">Jump to the Answer</a></p></li>
<li><p>Exercises 9.7 (Page 278, Statistical Computing with R). <a href="#question2ans">Jump to the Answer</a></p></li>
</ol>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 9.4</h3>
<p><strong>Problem.</strong> Implement a random walk Metropolis sampler
for generating the standard Laplace distribution (see Exercise 3.2). For
the increment, simulate from a normal distribution. Compare the chains
generated when different variances are used for the proposal
distribution. Also, compute the acceptance rates of each chain.</p>
<p><strong>Solution.</strong> The standard Laplace distribution has the
density function <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},\quad x\in R\)</span>.
Then we can calculate <span class="math inline">\(EX=0,VarX=2\)</span>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">list</span>())</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12321</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chain</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>rw.Metropolis<span class="ot">=</span><span class="cf">function</span>(sigma,x0,N){</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">numeric</span>(N)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">=</span>x0</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">=</span><span class="fu">runif</span>(N)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span><span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fu">abs</span>(y)))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>      x[i]<span class="ot">=</span>y <span class="cf">else</span>{</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>        x[i]<span class="ot">=</span>x[i<span class="dv">-1</span>]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>        k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">15000</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="dv">8</span>)</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">=</span><span class="dv">25</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>rw1<span class="ot">=</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>rw2<span class="ot">=</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>rw3<span class="ot">=</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>rw4<span class="ot">=</span><span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="co">#the acceptance rates of each chain</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k,rw4<span class="sc">$</span>k)<span class="sc">/</span>N,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.890 0.830 0.601 0.191</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compare the chains with different variances</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>rw<span class="ot">=</span><span class="fu">cbind</span>(rw1<span class="sc">$</span>x,rw2<span class="sc">$</span>x,rw3<span class="sc">$</span>x,rw4<span class="sc">$</span>x)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rw[,j],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span>.(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>We can see that the third one(<span class="math inline">\(\sigma=1.5\)</span>) mixes best.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">t</span>(rw), <span class="dv">1</span>, cumsum))</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.142282</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span>i,<span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
It can be seen that for the four chains we generated before, <span class="math inline">\(\hat{R}\)</span> is less than 1.2 after 8000
iterations.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercise 9.7</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\(\left(X_t,
Y_t\right)\)</span> with zero means, unit standard deviations, and
correlation 0.9. Plot the generated sample after discarding a suitable
burn-in sample. Fit a simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1 X\)</span> to the sample and
check the residuals of the model for normality and constant
variance.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">list</span>())</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chain</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> .<span class="dv">9</span> <span class="co">#correlation</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">cex=</span>.<span class="dv">5</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),<span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]),<span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span><span class="fu">lm</span>(x[,<span class="dv">2</span>]<span class="sc">~</span>x[,<span class="dv">1</span>])</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(L)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.84876 -0.29513  0.00229  0.29045  1.65081 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.001039   0.003693   0.281    0.778    
## x[, 1]      0.895937   0.003765 237.957   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4369 on 13998 degrees of freedom
## Multiple R-squared:  0.8018, Adjusted R-squared:  0.8018 
## F-statistic: 5.662e+04 on 1 and 13998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>p-value&lt;0.05, this model can be accepted.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L<span class="sc">$</span>fitted.values,L<span class="sc">$</span>residuals)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(L<span class="sc">$</span>residuals)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(L<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#compute diagnostic statistics</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(<span class="fu">t</span>(X), <span class="dv">1</span>, cumsum))</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 0.9999663</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(psi[i, b<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span>i,<span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> b<span class="sc">:</span>N)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[b<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
This time, <span class="math inline">\(\hat{R}\)</span> is always less
than 1.2, and the convergence of this chain is good.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 1 in class. <a href="#question1ans">Jump to the
Answer</a></p></li>
<li><p>Exercises 2 in class. <a href="#question2ans">Jump to the
Answer</a></p></li>
</ol>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercises 1 in class</h3>
<p><strong>Problem.</strong> Test intermediary effect.</p>
<p><strong>Solution.</strong> Using the above two models, firstly, we
obtain the data <span class="math inline">\((X_i,M_i,Y_i),\quad
i=1,2,\cdots,n\)</span>.</p>
<p>(1)test <span class="math inline">\(\alpha=0\)</span>, we use the
first model. By replacing the values of <span class="math inline">\(\boldsymbol{X}\)</span> and <span class="math inline">\(\boldsymbol{M}\)</span>, we get <span class="math inline">\((X_{i_1},\cdots,X_{i_n})\)</span> and <span class="math inline">\((M_{i_1},\cdots,M_{i_n})\)</span>. Use each set of
data to fit the model, and separately calculate the p-value. At last
calculate the mean of p-value, we can get the final result.</p>
<p>(2)test <span class="math inline">\(\beta=0\)</span>, as same as the
first method, we use the second model and replace the value of <span class="math inline">\(\boldsymbol{M}\)</span> and <span class="math inline">\(\boldsymbol{Y}\)</span>. Calculate the p-value of
<span class="math inline">\(\beta\)</span> and compare.</p>
<p>(3)test <span class="math inline">\(\alpha=0\)</span> and <span class="math inline">\(\beta=0\)</span>, this time we use the second
method and replace both the three values. And then we can see if the
three <span class="math inline">\(\boldsymbol{X},\boldsymbol{M},\boldsymbol{Y}\)</span>
is independent.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercises 2 in class</h3>
<p><strong>Problem.</strong> Consider the model <span class="math inline">\(P(Y=1\mid
X_1,X_2,X_3)=\text{expit}(a+b_1x_1+b_2x_2+b_3x_3)\)</span>.</p>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">list</span>())</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">=</span><span class="fu">rpois</span>(N,<span class="dv">1</span>);x2<span class="ot">=</span><span class="fu">rexp</span>(N,<span class="dv">1</span>);x3<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,N,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>   tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>   p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fl">1e6</span>;b1<span class="ot">=</span><span class="dv">0</span>;b2<span class="ot">=</span><span class="dv">1</span>;b3<span class="ot">=</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>f0<span class="ot">=</span><span class="fu">c</span>(<span class="fl">1e-1</span>,<span class="fl">1e-2</span>,<span class="fl">1e-3</span>,<span class="fl">1e-4</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>al<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)) {</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  al<span class="ot">=</span><span class="fu">c</span>(al,<span class="fu">p</span>(N,b1,b2,b3,f0[i]))</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(al,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  -3.165  -6.067  -8.713 -11.227</code></pre>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(f0),al)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises in class. <a href="#question1ans">Jump to the
Answer</a></p></li>
<li><p>Exercises 4,5 (Pages 19 Advanced in R). <a href="#question2ans">Jump to the Answer</a></p></li>
<li><p>Exercises 1,2 (Pages 26 Advanced in R). <a href="#question3ans">Jump to the Answer</a></p></li>
<li><p>Exercises 1,2,3 (Pages 30 Advanced in R). <a href="#question3ans">Jump to the Answer</a></p></li>
</ol>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercises in class</h3>
<p><strong>Problem.</strong></p>
<p>As I cant place pictures, please refer to the specific
assignments.</p>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>As I cant place pictures, please refer to the specific
assignments.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>rm<span class="ot">=</span><span class="fu">c</span>(<span class="fu">list</span>())</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="do">## maximum likelihood</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span><span class="cf">function</span>(lambda){</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((v<span class="sc">-</span>u)<span class="sc">/</span>(<span class="fu">exp</span>(lambda<span class="sc">*</span>(v<span class="sc">-</span>u))<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span>u)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>lambda1<span class="ot">=</span><span class="fu">uniroot</span>(L,<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))<span class="sc">$</span>root</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>lambda1</span></code></pre></div>
<pre><code>## [1] 0.07197522</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">## EM</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>EM<span class="ot">=</span><span class="cf">function</span>(u,v,<span class="at">max.it=</span><span class="dv">10000</span>,<span class="at">eps=</span><span class="fl">1e-5</span>){</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  lambda1<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  lambda2<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(u)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>lambda<span class="sc">+</span>u<span class="sc">-</span>(v<span class="sc">-</span>u)<span class="sc">/</span>(<span class="fu">exp</span>(lambda<span class="sc">*</span>(v<span class="sc">-</span>u))<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda2)<span class="sc">&gt;=</span>eps){</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    lambda1<span class="ot">=</span>lambda2</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    lambda2<span class="ot">=</span>n<span class="sc">/</span>x</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">=</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">/</span>lambda2<span class="sc">+</span>u<span class="sc">-</span>(v<span class="sc">-</span>u)<span class="sc">/</span>(<span class="fu">exp</span>(lambda2<span class="sc">*</span>(v<span class="sc">-</span>u))<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i <span class="sc">==</span> max.it) <span class="cf">break</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda2)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a><span class="fu">EM</span>(u,v,<span class="at">max.it=</span><span class="dv">10000</span>,<span class="at">eps=</span><span class="fl">1e-5</span>)</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>You can see that the two values are basically equal.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercises 4,5</h3>
<p><strong>Problem.</strong></p>
<ol start="4" style="list-style-type: decimal">
<li><p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesnt as. vector() work?</p></li>
<li><p>Why is <span class="math inline">\(1==\)</span> 1 true? Why is
<span class="math inline">\(-1\)</span> &lt; FaLSE true? Why is one
<span class="math inline">\(&lt;2\)</span> false?</p></li>
</ol>
<p><strong>Solution.</strong></p>
<ol start="4" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">unlist</span>(a)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.atomic</span>(b)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span><span class="fu">as.vector</span>(a)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>c</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] 3
## 
## [[4]]
## [1] 4</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.atomic</span>(c)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Given a list structure x, unlist simplifies it to produce a vector
which contains all the atomic components which occur in x.</p>
<p>When x is of type list or expression, as.vector(x) currently
returns the argument x unchanged.</p>
<ol start="5" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">==</span><span class="st">&#39;1&#39;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span><span class="sc">&lt;</span><span class="cn">FALSE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;one&#39;</span><span class="sc">&lt;</span><span class="dv">4</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>When a logical vector is coerced to an integer or double, TRUE
becomes 1 and FALSE becomes 0. So -1 &lt; FALSE because -1 &lt; 0.</p>
<p>The hierarchy for coercion is: logical &lt; integer &lt; numeric &lt;
character. So in both cases, the numeric is coerced to character.
Characters get sorted position by position in ASCII order. So 1 is
equal to 1 and one is greater than 4.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercises 1,2</h3>
<p><strong>Problem.</strong></p>
<ol style="list-style-type: decimal">
<li><p>What does <span class="math inline">\(\operatorname{dim}()\)</span> return when applied
to a vector?</p></li>
<li><p>If is.matrix(x) is TRUE, what will is. <span class="math inline">\(\operatorname{array}(\mathrm{x})\)</span>
return?</p></li>
</ol>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(a)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>It returns NULL.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">array</span>(x)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(b)</span></code></pre></div>
<pre><code>## [1] &quot;array&quot;</code></pre>
<p>It returns an array with the data in x, and the dim depends on the
number of data.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question4ans" class="section level3">
<h3>Exercises 1,2,3</h3>
<p><strong>Problem.</strong></p>
<ol style="list-style-type: decimal">
<li><p>What attributes does a data frame possess?</p></li>
<li><p>What does as.matrix() do when applied to a data frame with
columns of different types?</p></li>
<li><p>Can you have a data frame with 0 rows? What about 0
columns?</p></li>
</ol>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>A data frame is a list of equal-length vectors. This makes it a
2-dimensional structure, so it shares properties of both the matrix and
the list. This means that a data frame has names(), colnames(), and
rownames(), although names() and colnames() are the same thing. The
length() of a data frame is the length of the underlying list and so is
the same as ncol(); nrow() gives the number of rows.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">a=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">b=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(a)</span></code></pre></div>
<pre><code>##      a   b  
## [1,] &quot;1&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;b&quot;</code></pre>
<p>The usual coercion hierarchy (logical &lt; integer &lt; double &lt;
complex) will be used, e.g., all-logical data frames will be coerced to
a logical matrix, mixed logical-integer will give a integer matrix,
etc.</p>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">0</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">as.data.frame</span>(a)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(b)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(b)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(b)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>We can create such a data frame.</p>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Exercises 2 (page 204, Advanced R). <a href="#question1ans">Jump
to the Answer</a></p></li>
<li><p>Exercises 1 (page 213, Advanced R). <a href="#question2ans">Jump
to the Answer</a></p></li>
<li><p>Exercises in class. <a href="#question3ans">Jump to the
Answer</a></p></li>
</ol>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div id="question1ans" class="section level3">
<h3>Exercises 2</h3>
<p><strong>Problem.</strong> The function below scales a vector so it
falls in the range <span class="math inline">\([0\)</span>, <span class="math inline">\(1]\)</span>. How would you apply it to every
column of a data frame? How would you apply it to every numeric column
in a data frame?</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>scale01<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  rng<span class="ot">=</span><span class="fu">range</span>(x,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  (x<span class="sc">-</span>rng[<span class="dv">1</span>])<span class="sc">/</span>(rng[<span class="dv">2</span>]<span class="sc">-</span>rng[<span class="dv">1</span>])</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong> We can implement it with the function
lapply. Take the data frame mtcars as an example, which is
numeric.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(mtcars, scale01)</span></code></pre></div>
<pre><code>## $mpg
##  [1] 0.4510638 0.4510638 0.5276596 0.4680851 0.3531915 0.3276596 0.1659574
##  [8] 0.5957447 0.5276596 0.3744681 0.3148936 0.2553191 0.2936170 0.2042553
## [15] 0.0000000 0.0000000 0.1829787 0.9361702 0.8510638 1.0000000 0.4723404
## [22] 0.2170213 0.2042553 0.1234043 0.3744681 0.7191489 0.6638298 0.8510638
## [29] 0.2297872 0.3957447 0.1957447 0.4680851
## 
## $cyl
##  [1] 0.5 0.5 0.0 0.5 1.0 0.5 1.0 0.0 0.0 0.5 0.5 1.0 1.0 1.0 1.0 1.0 1.0 0.0 0.0
## [20] 0.0 0.0 1.0 1.0 1.0 1.0 0.0 0.0 0.0 1.0 0.5 1.0 0.0
## 
## $disp
##  [1] 0.22175106 0.22175106 0.09204290 0.46620105 0.72062859 0.38388626
##  [7] 0.72062859 0.18857570 0.17385882 0.24070841 0.24070841 0.51060115
## [13] 0.51060115 0.51060115 1.00000000 0.97006735 0.92017960 0.01895735
## [19] 0.01147418 0.00000000 0.12222499 0.61586431 0.58094288 0.69568471
## [25] 0.82040409 0.01970566 0.12272387 0.05986530 0.69817910 0.18433525
## [31] 0.57345972 0.12446994
## 
## $hp
##  [1] 0.20494700 0.20494700 0.14487633 0.20494700 0.43462898 0.18727915
##  [7] 0.68197880 0.03533569 0.15194346 0.25088339 0.25088339 0.45229682
## [13] 0.45229682 0.45229682 0.54063604 0.57597173 0.62897527 0.04946996
## [19] 0.00000000 0.04593640 0.15901060 0.34628975 0.34628975 0.68197880
## [25] 0.43462898 0.04946996 0.13780919 0.21554770 0.74911661 0.43462898
## [31] 1.00000000 0.20141343
## 
## $drat
##  [1] 0.52534562 0.52534562 0.50230415 0.14746544 0.17972350 0.00000000
##  [7] 0.20737327 0.42857143 0.53456221 0.53456221 0.53456221 0.14285714
## [13] 0.14285714 0.14285714 0.07834101 0.11059908 0.21658986 0.60829493
## [19] 1.00000000 0.67281106 0.43317972 0.00000000 0.17972350 0.44700461
## [25] 0.14746544 0.60829493 0.76958525 0.46543779 0.67281106 0.39631336
## [31] 0.35944700 0.62211982
## 
## $wt
##  [1] 0.28304781 0.34824853 0.20634109 0.43518282 0.49271286 0.49782664
##  [7] 0.52595244 0.42879059 0.41856303 0.49271286 0.49271286 0.65379698
## [13] 0.56686269 0.57964715 0.95551010 1.00000000 0.97980056 0.17565840
## [19] 0.02608029 0.08233188 0.24341601 0.51316799 0.49143442 0.59498849
## [25] 0.59626694 0.10790079 0.16031705 0.00000000 0.42367681 0.32140118
## [31] 0.52595244 0.32395807
## 
## $qsec
##  [1] 0.23333333 0.30000000 0.48928571 0.58809524 0.30000000 0.68095238
##  [7] 0.15952381 0.65476190 1.00000000 0.45238095 0.52380952 0.34523810
## [13] 0.36904762 0.41666667 0.41428571 0.39523810 0.34761905 0.59166667
## [19] 0.47857143 0.64285714 0.65595238 0.28214286 0.33333333 0.10833333
## [25] 0.30357143 0.52380952 0.26190476 0.28571429 0.00000000 0.11904762
## [31] 0.01190476 0.48809524
## 
## $vs
##  [1] 0 0 1 1 0 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 0 1 0 0 0 1
## 
## $am
##  [1] 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 1 1 1 1 1 1 1
## 
## $gear
##  [1] 0.5 0.5 0.5 0.0 0.0 0.0 0.0 0.5 0.5 0.5 0.5 0.0 0.0 0.0 0.0 0.0 0.0 0.5 0.5
## [20] 0.5 0.0 0.0 0.0 0.0 0.0 0.5 1.0 1.0 1.0 1.0 1.0 0.5
## 
## $carb
##  [1] 0.4285714 0.4285714 0.0000000 0.0000000 0.1428571 0.0000000 0.4285714
##  [8] 0.1428571 0.1428571 0.4285714 0.4285714 0.2857143 0.2857143 0.2857143
## [15] 0.4285714 0.4285714 0.4285714 0.0000000 0.1428571 0.0000000 0.0000000
## [22] 0.1428571 0.1428571 0.4285714 0.1428571 0.0000000 0.1428571 0.1428571
## [29] 0.4285714 0.7142857 1.0000000 0.1428571</code></pre>
<p>First, we use lapply and class to screen out the numeric column.
And then we can use lapply to implement it. Take the data frame iris
as an example, which is mixed.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(iris[,<span class="fu">lapply</span>(iris,class)<span class="sc">==</span><span class="st">&quot;numeric&quot;</span>],scale01)</span></code></pre></div>
<pre><code>## $Sepal.Length
##   [1] 0.22222222 0.16666667 0.11111111 0.08333333 0.19444444 0.30555556
##   [7] 0.08333333 0.19444444 0.02777778 0.16666667 0.30555556 0.13888889
##  [13] 0.13888889 0.00000000 0.41666667 0.38888889 0.30555556 0.22222222
##  [19] 0.38888889 0.22222222 0.30555556 0.22222222 0.08333333 0.22222222
##  [25] 0.13888889 0.19444444 0.19444444 0.25000000 0.25000000 0.11111111
##  [31] 0.13888889 0.30555556 0.25000000 0.33333333 0.16666667 0.19444444
##  [37] 0.33333333 0.16666667 0.02777778 0.22222222 0.19444444 0.05555556
##  [43] 0.02777778 0.19444444 0.22222222 0.13888889 0.22222222 0.08333333
##  [49] 0.27777778 0.19444444 0.75000000 0.58333333 0.72222222 0.33333333
##  [55] 0.61111111 0.38888889 0.55555556 0.16666667 0.63888889 0.25000000
##  [61] 0.19444444 0.44444444 0.47222222 0.50000000 0.36111111 0.66666667
##  [67] 0.36111111 0.41666667 0.52777778 0.36111111 0.44444444 0.50000000
##  [73] 0.55555556 0.50000000 0.58333333 0.63888889 0.69444444 0.66666667
##  [79] 0.47222222 0.38888889 0.33333333 0.33333333 0.41666667 0.47222222
##  [85] 0.30555556 0.47222222 0.66666667 0.55555556 0.36111111 0.33333333
##  [91] 0.33333333 0.50000000 0.41666667 0.19444444 0.36111111 0.38888889
##  [97] 0.38888889 0.52777778 0.22222222 0.38888889 0.55555556 0.41666667
## [103] 0.77777778 0.55555556 0.61111111 0.91666667 0.16666667 0.83333333
## [109] 0.66666667 0.80555556 0.61111111 0.58333333 0.69444444 0.38888889
## [115] 0.41666667 0.58333333 0.61111111 0.94444444 0.94444444 0.47222222
## [121] 0.72222222 0.36111111 0.94444444 0.55555556 0.66666667 0.80555556
## [127] 0.52777778 0.50000000 0.58333333 0.80555556 0.86111111 1.00000000
## [133] 0.58333333 0.55555556 0.50000000 0.94444444 0.55555556 0.58333333
## [139] 0.47222222 0.72222222 0.66666667 0.72222222 0.41666667 0.69444444
## [145] 0.66666667 0.66666667 0.55555556 0.61111111 0.52777778 0.44444444
## 
## $Sepal.Width
##   [1] 0.62500000 0.41666667 0.50000000 0.45833333 0.66666667 0.79166667
##   [7] 0.58333333 0.58333333 0.37500000 0.45833333 0.70833333 0.58333333
##  [13] 0.41666667 0.41666667 0.83333333 1.00000000 0.79166667 0.62500000
##  [19] 0.75000000 0.75000000 0.58333333 0.70833333 0.66666667 0.54166667
##  [25] 0.58333333 0.41666667 0.58333333 0.62500000 0.58333333 0.50000000
##  [31] 0.45833333 0.58333333 0.87500000 0.91666667 0.45833333 0.50000000
##  [37] 0.62500000 0.66666667 0.41666667 0.58333333 0.62500000 0.12500000
##  [43] 0.50000000 0.62500000 0.75000000 0.41666667 0.75000000 0.50000000
##  [49] 0.70833333 0.54166667 0.50000000 0.50000000 0.45833333 0.12500000
##  [55] 0.33333333 0.33333333 0.54166667 0.16666667 0.37500000 0.29166667
##  [61] 0.00000000 0.41666667 0.08333333 0.37500000 0.37500000 0.45833333
##  [67] 0.41666667 0.29166667 0.08333333 0.20833333 0.50000000 0.33333333
##  [73] 0.20833333 0.33333333 0.37500000 0.41666667 0.33333333 0.41666667
##  [79] 0.37500000 0.25000000 0.16666667 0.16666667 0.29166667 0.29166667
##  [85] 0.41666667 0.58333333 0.45833333 0.12500000 0.41666667 0.20833333
##  [91] 0.25000000 0.41666667 0.25000000 0.12500000 0.29166667 0.41666667
##  [97] 0.37500000 0.37500000 0.20833333 0.33333333 0.54166667 0.29166667
## [103] 0.41666667 0.37500000 0.41666667 0.41666667 0.20833333 0.37500000
## [109] 0.20833333 0.66666667 0.50000000 0.29166667 0.41666667 0.20833333
## [115] 0.33333333 0.50000000 0.41666667 0.75000000 0.25000000 0.08333333
## [121] 0.50000000 0.33333333 0.33333333 0.29166667 0.54166667 0.50000000
## [127] 0.33333333 0.41666667 0.33333333 0.41666667 0.33333333 0.75000000
## [133] 0.33333333 0.33333333 0.25000000 0.41666667 0.58333333 0.45833333
## [139] 0.41666667 0.45833333 0.45833333 0.45833333 0.29166667 0.50000000
## [145] 0.54166667 0.41666667 0.20833333 0.41666667 0.58333333 0.41666667
## 
## $Petal.Length
##   [1] 0.06779661 0.06779661 0.05084746 0.08474576 0.06779661 0.11864407
##   [7] 0.06779661 0.08474576 0.06779661 0.08474576 0.08474576 0.10169492
##  [13] 0.06779661 0.01694915 0.03389831 0.08474576 0.05084746 0.06779661
##  [19] 0.11864407 0.08474576 0.11864407 0.08474576 0.00000000 0.11864407
##  [25] 0.15254237 0.10169492 0.10169492 0.08474576 0.06779661 0.10169492
##  [31] 0.10169492 0.08474576 0.08474576 0.06779661 0.08474576 0.03389831
##  [37] 0.05084746 0.06779661 0.05084746 0.08474576 0.05084746 0.05084746
##  [43] 0.05084746 0.10169492 0.15254237 0.06779661 0.10169492 0.06779661
##  [49] 0.08474576 0.06779661 0.62711864 0.59322034 0.66101695 0.50847458
##  [55] 0.61016949 0.59322034 0.62711864 0.38983051 0.61016949 0.49152542
##  [61] 0.42372881 0.54237288 0.50847458 0.62711864 0.44067797 0.57627119
##  [67] 0.59322034 0.52542373 0.59322034 0.49152542 0.64406780 0.50847458
##  [73] 0.66101695 0.62711864 0.55932203 0.57627119 0.64406780 0.67796610
##  [79] 0.59322034 0.42372881 0.47457627 0.45762712 0.49152542 0.69491525
##  [85] 0.59322034 0.59322034 0.62711864 0.57627119 0.52542373 0.50847458
##  [91] 0.57627119 0.61016949 0.50847458 0.38983051 0.54237288 0.54237288
##  [97] 0.54237288 0.55932203 0.33898305 0.52542373 0.84745763 0.69491525
## [103] 0.83050847 0.77966102 0.81355932 0.94915254 0.59322034 0.89830508
## [109] 0.81355932 0.86440678 0.69491525 0.72881356 0.76271186 0.67796610
## [115] 0.69491525 0.72881356 0.76271186 0.96610169 1.00000000 0.67796610
## [121] 0.79661017 0.66101695 0.96610169 0.66101695 0.79661017 0.84745763
## [127] 0.64406780 0.66101695 0.77966102 0.81355932 0.86440678 0.91525424
## [133] 0.77966102 0.69491525 0.77966102 0.86440678 0.77966102 0.76271186
## [139] 0.64406780 0.74576271 0.77966102 0.69491525 0.69491525 0.83050847
## [145] 0.79661017 0.71186441 0.67796610 0.71186441 0.74576271 0.69491525
## 
## $Petal.Width
##   [1] 0.04166667 0.04166667 0.04166667 0.04166667 0.04166667 0.12500000
##   [7] 0.08333333 0.04166667 0.04166667 0.00000000 0.04166667 0.04166667
##  [13] 0.00000000 0.00000000 0.04166667 0.12500000 0.12500000 0.08333333
##  [19] 0.08333333 0.08333333 0.04166667 0.12500000 0.04166667 0.16666667
##  [25] 0.04166667 0.04166667 0.12500000 0.04166667 0.04166667 0.04166667
##  [31] 0.04166667 0.12500000 0.00000000 0.04166667 0.04166667 0.04166667
##  [37] 0.04166667 0.00000000 0.04166667 0.04166667 0.08333333 0.08333333
##  [43] 0.04166667 0.20833333 0.12500000 0.08333333 0.04166667 0.04166667
##  [49] 0.04166667 0.04166667 0.54166667 0.58333333 0.58333333 0.50000000
##  [55] 0.58333333 0.50000000 0.62500000 0.37500000 0.50000000 0.54166667
##  [61] 0.37500000 0.58333333 0.37500000 0.54166667 0.50000000 0.54166667
##  [67] 0.58333333 0.37500000 0.58333333 0.41666667 0.70833333 0.50000000
##  [73] 0.58333333 0.45833333 0.50000000 0.54166667 0.54166667 0.66666667
##  [79] 0.58333333 0.37500000 0.41666667 0.37500000 0.45833333 0.62500000
##  [85] 0.58333333 0.62500000 0.58333333 0.50000000 0.50000000 0.50000000
##  [91] 0.45833333 0.54166667 0.45833333 0.37500000 0.50000000 0.45833333
##  [97] 0.50000000 0.50000000 0.41666667 0.50000000 1.00000000 0.75000000
## [103] 0.83333333 0.70833333 0.87500000 0.83333333 0.66666667 0.70833333
## [109] 0.70833333 1.00000000 0.79166667 0.75000000 0.83333333 0.79166667
## [115] 0.95833333 0.91666667 0.70833333 0.87500000 0.91666667 0.58333333
## [121] 0.91666667 0.79166667 0.79166667 0.70833333 0.83333333 0.70833333
## [127] 0.70833333 0.70833333 0.83333333 0.62500000 0.75000000 0.79166667
## [133] 0.87500000 0.58333333 0.54166667 0.91666667 0.95833333 0.70833333
## [139] 0.70833333 0.83333333 0.95833333 0.91666667 0.75000000 0.91666667
## [145] 1.00000000 0.91666667 0.75000000 0.79166667 0.91666667 0.70833333</code></pre>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question2ans" class="section level3">
<h3>Exercises 1</h3>
<p><strong>Problem.</strong> Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: youll need to use vapply() twice.)</p></li>
</ol>
<p><strong>Solution.</strong> We still use mtcars and iris as
examples.</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars,sd,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(iris[,<span class="fu">vapply</span>(iris,class,<span class="st">&#39;&#39;</span>)<span class="sc">==</span><span class="st">&#39;numeric&#39;</span>],sd,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<p><a href="#question">Back to the Question</a></p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercises in class</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\(\left(X_t,
Y_t\right)\)</span> with zero means, unit standard deviations, and
correlation <span class="math inline">\(0.9\)</span>.</p>
<ul>
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the corresponding generated random numbers with pure
<span class="math inline">\(\mathrm{R}\)</span> language using the
function qqplot.</p></li>
<li><p>Compare the computation time of the two functions with the
function microbenchmark.</p></li>
</ul>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>burn<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span>burn<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>mu1<span class="ot">=</span>mu2<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">=</span>sigma2<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>rho<span class="ot">=</span><span class="fl">0.9</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22031)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">gibbs_cpp</span>(N,mu1,mu2,sigma1,sigma2,rho)</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span><span class="fu">gibbs_r</span>(N,mu1,mu2,sigma1,sigma2,rho)</span></code></pre></div>
<p>an Rcpp function:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>NumericMatrix <span class="fu">gibbs_cpp</span>(int N,double mu1,double mu2,double sigma1,double sigma2,double rho){</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  NumericMatrix <span class="fu">X</span>(N,<span class="dv">2</span>);</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  double s1,s2;</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pow</span>(rho,<span class="dv">2</span>))<span class="sc">*</span>sigma1;</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  s2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pow</span>(rho,<span class="dv">2</span>))<span class="sc">*</span>sigma2;</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">0</span>)<span class="ot">=</span>mu1;</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="ot">=</span>mu2;</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  double x1,x2,m1,m2;</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i=</span><span class="dv">1</span>;i<span class="sc">&lt;</span>N;i<span class="sc">++</span>){</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    x2<span class="ot">=</span><span class="fu">X</span>(i<span class="dv">-1</span>,<span class="dv">1</span>);</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span>mu1<span class="sc">+</span>rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2;</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">0</span>)<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)[<span class="dv">0</span>];</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">=</span><span class="fu">X</span>(i,<span class="dv">0</span>);</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">=</span>mu2<span class="sc">+</span>rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1;</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">1</span>)<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)[<span class="dv">0</span>];</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X);</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>pure <span class="math inline">\(\mathrm{R}\)</span> language:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>gibbs_r<span class="ot">=</span><span class="cf">function</span>(N,mu1,mu2,sigma1,sigma2,rho){</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  s2<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">=</span><span class="fu">c</span>(mu1,mu2)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    x2<span class="ot">=</span>X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span>mu1<span class="sc">+</span>rho<span class="sc">*</span>(x2<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">=</span>X[i,<span class="dv">1</span>]</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    m2<span class="ot">=</span>mu2<span class="sc">+</span>rho<span class="sc">*</span>(x1<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>compare the corresponding generated random numbers:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span>x1[b<span class="sc">:</span>N,]</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span>x2[b<span class="sc">:</span>N,]</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(x1,x2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Compare the computation time:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(<span class="fu">gibbs_cpp</span>(<span class="dv">5000</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>),<span class="fu">gibbs_r</span>(<span class="dv">5000</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>))</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                              expr     min      lq      mean   median      uq
##  gibbs_cpp(5000, 0, 0, 1, 1, 0.9)  1.2277  1.2461  1.267153  1.26025  1.2796
##    gibbs_r(5000, 0, 0, 1, 1, 0.9) 16.7060 16.8961 18.911833 17.14755 22.6901
##      max neval
##   1.4815   100
##  27.5735   100</code></pre>
<p><a href="#question">Back to the Question</a></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
